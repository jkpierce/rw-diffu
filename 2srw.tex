\documentclass[11pt]{article}
% General document formatting
\usepackage[margin=0.75in]{geometry}
\usepackage[parfill]{parskip}
\usepackage[utf8]{inputenc}
\usepackage{subfig}         % side-by-side figures 
% Related to math
\usepackage{amsmath,amssymb,amsfonts,amsthm}
\usepackage{graphicx}
\usepackage{natbib}
\usepackage{titling}
\usepackage{hyperref}
\usepackage{wrapfig}
\usepackage{booktabs} % for wrapping tabulars in accord with
\bibliographystyle{agu}
\setlength{\droptitle}{-5em}   % This is your set screw

%\usepackage[math]{kurier}
\newcommand\be{\begin{equation}} % shortcut to start eq envs 
\newcommand\ee{\end{equation}}   % shortcut to end eq envs
\newcommand\ol{\overline}        % shortcut to draw overline 
\newcommand\bra{\langle}
\newcommand\ket{\rangle}
\newcommand\El{\mathcal{L}}
\newcommand\tg{\tilde{g}}
\newcommand\tG{\tilde{G}}
\begin{document}

\title{Analytical derivation of three-stage bedload diffusion}
\author{Kevin Pierce}
\maketitle

\section{Two-state random walk formalism}
The formalism of two-state random walks \citep[e.g.][]{Weiss1976,Weiss1994,Masoliver2016,Masoliver2017} provides new traction on the problem of 3-stage diffusion in bedload transport \citep[e.g.][]{Nikora2001a,Nikora2002,Zhang2012,Fan2016}.
Assuming residence time distributions $\psi_\pm(t)$ in each state with associated survival probabilities $\Psi_\pm(t) = \int_t^\infty dt' \psi_\pm(t')$, probabilities of moving a distance $x$ up to time $t$ within a sojourn $f_\pm(x,t)$, denoting $g_\pm(x,t) =f_\pm(x,t)\psi_\pm(t)$ and $G_\pm(x,t) = f_\pm(x,t)\Psi_\pm(x,t)$, and letting $\omega_\pm(x,t)$ be the probability that a sojourn in state $\pm$ ends at $x,t$ provides
\be  p_\pm(x,t) = \theta_+ G_\pm(x,t) + \int_0^\infty dx' \int_0^\infty dt' \omega_{\mp}(x',t')G_\pm(x-x',t-t')\ee
and 
\be \omega_\pm(x,t) = \theta_\pm g_\pm(x,t) + \int_0^\infty dx' \int_0^\infty dt' \omega_\mp(x',t')g_\pm(x-x',t-t').\label{eq:two}\ee
Here $\theta_\pm$ are the initial probabilities of being in each state with $\theta_+ + \theta_-=1.$
The probability of the two-state random walker being at position $x$ at time $t$ is 
\be p(x,t) = p_-(x,t)+p_+(x,t).\ee
Denoting the laplace transform with respect to the variable $q$ as $\El_q$ and associating variables $\eta$ and $s$ with $\El_x$ and $\El_t$, 
taking $\El_x \El_t$ of (\ref{eq:two}) provides a much simpler algebraic problem for the probability $p$:

\be
\tilde{\omega}_\pm = 
\frac{[\theta_\pm+ \theta_\mp \tilde{g}_\mp]\tilde{g}_\pm}{1-\tilde{g}_-\tilde{g}_+}
\ee
and (c.f. \citet{Masoliver2016} eq. 20)
\be
\tilde{p}_\pm = \Big( \theta_\pm + \tilde{\omega}_\mp \Big)\tilde{G}_\pm = \frac{\theta_\pm + \theta_\mp \tilde{g}_\mp}{1- \tilde{g}_-\tilde{g}_+}\tilde{G}_\pm.
\ee
Therefore the double transform of the joint PDF reads (c.f. \citet{Masoliver2016} eq. )
\be
\tilde{p}(\eta,s) = \frac{\big\{ \theta_- + \theta_+ \tg_+\big\}\tG_- + \big\{\theta_+ + \theta_-\tg_-\big\}\tG_+}{1-\tg_-\tg_+}
\label{eq:mw}\ee
This is a direct generalization of the famous Montroll-Weiss formula for a single state continuous-time random walk \citep[e.g.][]{Weiss1994}.

For the evaluation of this formula, a useful fact to take account of is 
\be \El_t\{ \Psi_\pm(t);s\} = \int_0^\infty dt e^{-st} \int_t^\infty dt' \psi_\pm(t') = \frac{1-\tilde{\psi}(s)}{s}. \ee
Finally, owing to the definition of the double Laplace transform of $p(x,t)$:
\be \tilde{p}(\eta,s) = \int_0^\infty dt e^{-st} \int_0^\infty dx e^{-\eta x} p(x,t)\ee
we see the (double) inverse transform $p(x,t)$ may not be necessary to study the scaling of the variance $\bra x(t)^2 \ket = \int_0^\infty x^2 p(x,t)$ of the bedload tracer cloud since its Laplace transform follows from the second derivative of the double transform of $p$ wrt $\eta$:
\be \El_t\{ \bra x(t)^2 \ket;s\} = \partial_\eta^2 \tilde{p}(\eta,s)\Big|_{\eta=0}. \label{eq:var}
\ee
I hope this allows evaluation of three-stage diffusion.
More generally, 
\be \El_t\{\bra x(t)^k\ket;s\} = (-)^k\partial_\eta^k \tilde{p}(\eta,s)\Big|_{\eta=0}.\ee

Actually, it may be easier to work with a cumulant-type expression since unlike \citet{Masoliver2016,Masoliver2017} we consider asymmetric processes where $\bra x(t) \ket \neq 0$ necessarily.

\section{The Einstein theory}
Taking $g_-(x,t) = \delta(x)k_- e^{-k_-t}$ (rest) and $g_+(x,t) = k_+ e^{-k_+ x}\delta(t) $ (step) reproduces the \citet{Einstein1937} diffusion theory.
In this case the double transforms are: 
\be \tilde{g}_-(\eta,s) = \frac{k_-}{k_-+s}\ee
\be \tilde{g}_+(\eta,s) = \frac{k_+}{k_++\eta}, \ee
and the survival functions are 
\be \Psi_-(t) = \int_t^\infty dt' k_-e^{-k_- t'} = e^{-k_- t} \ee
and 
\be \Psi_+(t) = \int_t^\infty dt' \delta(t') = 0 ,  \ee
meaning $G_-(x,t) = \delta(x) e^{-k_- t}$ and $G_+(x,t) = 0,$ providing
\be \tG_-(\eta,s) = \frac{1}{k_-+s}.\ee
Taking $\theta_-=1$ and $\theta_+=0$, so the dynamics start at rest, the MW generalization (\ref{eq:mw}) is
\be \tilde{p}(\eta, s) = \frac{\tG_-}{1-\tg_-\tg_+} = \frac{1}{s + \frac{k_- \eta}{k_+ + \eta }}.\label{eq:mwgen}\ee
The Laplace transform of the mean is 
\be \El_t\{\bra x(t) \ket;s\} = \frac{k_-}{s^2 k_+}
\ee
so in real space it's $\bra x(t) \ket = k_- t/k_+$ as expected \citep[e.g.][]{Einstein1937, Nakagawa1976}.
The Laplace transform of the second moment is 
\be \El \{\bra x(t)^2 \ket; s\} = 2\Big(\frac{k_-}{k_+}\Big)^2 \Big[ \frac{1}{k_-}\frac{1}{s^2} + \frac{1}{s^3}\Big], \ee
so using the inversion formula 
\be \El\Big\{\frac{1}{s^{k+1}};s\Big\} = \frac{t^k}{k!}\ee
implies a second moment $\bra x(t)^2 \ket = (k_-/k_+)^2[2t/k_-+t^2] $
and a variance exemplifying the normal diffusion of bedload:
\be \sigma_x^2 = \text{var}\{x(t)\} = \frac{2k_-}{k_+^2}t.\ee
The diffusivity $D$ is given by the square of the mean step distance $1/k_+$ divided by the mean resting time $1/k_-$:
\be D_\text{Einstein} = \frac{k_-}{k_+^2}.\ee

Of course, for the Einstein theory a closed form solution of the pdf $p(x,t)$ is possible to obtain \citep[e.g.][]{Einstein1937, Hubbell1964, Daly2006,Daly2019}.
The first transform in (\ref{eq:mwgen}) inverts easily for \citep[i.e.][1.1.1.2]{Prudnikov1986}
\be \tilde{p}(\eta,t) = \exp\Big\{-\frac{k_-\eta }{k_+ + \eta} t\Big\}.\ee
Incidentally this single Laplace transform of $p$ provides the cumulant generating function $c(\eta,t) = \log \tilde{p}(-\eta,t)$ from which the variance follows from a more simple computation: $\sigma_x^2(t) = \partial_\eta^2 c(\eta,t)\big|_{\eta=0}.$
The second inversion follows from \citet[][2.2.2.8]{Prudnikov1986} noting $\El_x^{-1}\{1\} = \delta(x).$ The result is \citep[e.g.][]{Daly2019}
\be p(x,t) = e^{-k_- t -k_+ x}\Big\{ \sqrt{\frac{k_- k_+ t}{ x}} I_1\Big( 2\sqrt{k_-k_+ x t}\Big) + \delta(x) \Big\} .\ee
This exact solution has been the benchmark theory of bedload diffusion for over 100 years. I have only derived it within a more general framework of multi-state random walks \citep[e.g.][]{Weiss1994}.

\section{The Lisle Theory}
Apart from formulations of \citet{Einstein1937} using different step length and resting time distributions than exponential \citep[e.g.][]{Sayre1965}, the first significant advancement from \citet{Einstein1937} was due to \citet{Lisle1998}.
I need to carefully investigate whether \citet{Gordon1972} did it too.
They imparted a finite duration to bedload motions instead of considering them instantaneous like Einstein. In this way they derived two stages of bedload diffusion.
This approach is closely related to the so-called persistent diffusion model \citep{Balakrishnan1988,VanDenBroeck1990}, the diffusion of a particle driven by dichotomous Markov noise \citep[e.g.][]{Horsthemke1984,Risken1989,Bena2006}. 
The mathematics were essentially developed by Takacs (1957).

It is obtained by the choice $g_-(x,t) = \delta(x) k_- e^{-k_- t}$ (rest) and $g_+(x,t) = \delta(x-vt)k_+ e^{-k_+ t} $ (motion).
Hence motions occur with velocity $v$ for a duration characterized by an exponential distribution with mean $1/k_+$, while rests occur for a duration characterized by an exponential distribution with mean $1/k_-$. 
We consider each of the extreme initial conditions in turn.
\subsection{starting at rest}

If the process starts from rest, this means $\theta_- = 1$ and $\theta_+=0$.
In this case the Laplace transforms are
\be \tg_-(\eta,s) = \frac{k_-}{k_- + s}, \ee 
\be \tg_+(\eta,s) = \frac{k_+}{k_+ + \eta v + s }\ee
and
\be \tG_\pm(\eta,s) = \frac{1}{k_\pm}\tg_\pm(\eta,s).\ee
Plugging these into (\ref{eq:mw}) gives
\be \tilde{p}(\eta,s) = \frac{k + s + \eta v }{v(k_-+s) \eta  + k s + s^2 },\ee
where $k = k_- + k_+$. 
This inverts to 
\be \tilde{p}(x,s) = \frac{k(k+s)}{v(k_-+s)^2} \exp\Big[-\frac{s(k+s)}{v(k_-+s)}x\Big] + \frac{1}{k_-+s}\delta(x) .\ee
Using the property $ \El\{f(x+a);s\} = e^{as}\El\{f(x);s\}$ along with the transform of a modified Bessel function gives
\begin{multline}
p(x,t) = \delta(x) e^{-k_- t} + \frac{k}{v}\exp\Big[-\frac{k_+x }{v} - k_-\Big(t-\frac{x}{v}\Big)\Big]\Theta(t-x/v)\\ 
\times \Big\{ I_0\Big(2\sqrt{\frac{k_-k_+x}{v}\big(t-\frac{x}{v}\big)}\Big) \\
\sqrt{\frac{k_+ v(t-x/v)}{k_-x}}I_1\Big(2\sqrt{\frac{k_-k_+x}{v}\big(t-\frac{x}{v}\big)}\Big) 
\Big\},
\end{multline}
a non-trivial result.
The non-dimensionalization proposed by Lisle is $\xi = k_+ x /v$ and $\tau = k_-(t-x/v)$.
In this notation the result appears as
\be p(\xi,\tau) = \frac{k_+}{v}\delta(\xi)e^{-\tau-k_-\xi/k_+} +  \frac{k}{v}e^{-\xi-\tau}\Theta(\tau)\Theta(\xi)\Big\{I_0\big(2\sqrt{\xi \tau}\big) +\frac{k_+}{k_-}\sqrt{\frac{\tau}{\xi}}I_1\big(2\sqrt{\xi\tau}\big) \Big\}\ee

\subsubsection{moments having started at rest}
The first derivative gives 
\be \El\{\bra x(t) \ket;s\} = vk_- \frac{1}{s^2(s+k)},\ee
while the second gives 
\be \El\{\bra x^2(t) \ket ; s\} = 2 v^2 k_- \frac{s+k_-}{s^3(s+k)^2}. \ee
Therefore the mean is easy to obtain as 
\be \frac{k^2}{vk_-} \bra x \ket = e^{-kt} + kt -1,\ee
while the second moment is 
\begin{align}
 \frac{k^4}{2 v^2 k_-^2} \bra x^2\ket = \frac{(kt)^2}{2} - &2kt - (kt+3)e^{-kt} + 3 \\ 
 &+ \frac{k}{k_-}\big[kt -2 + (kt+2)e^{-kt}\big]. 
\end{align}
Manipulating the mean provides 
\be \frac{k^4}{2v^2k_-^2}\bra x \ket^2 = \frac{1}{2}e^{-2kt} + \frac{(kt)^2}{2} + \frac{1}{2} -kt + (-1 + kt)e^{-kt}, \ee
so the variance is 
\be \frac{k^4}{2v^2k_-^2} \sigma_x^2(t) = -kt -(2kt + 2)e^{-kt} + \frac{5}{2} - \frac{1}{2}e^{-2kt} + \frac{k}{k_-}\big[kt-2 + (kt +2)e^{-kt}\big].\ee
In this case as well, $t\rightarrow 0$ gives $\sigma_x^2 \propto t^3$.
This is a non-trivial result. The terms cancel each other in a highly coordinated way.
This result shows a sharp transition between two diffusion regimes when the mean time in motion is smaller than the mean time at rest.
When the opposite is true, there are three stages of diffusion with a sub-diffusive intermediate regime.
Therefore in Einstein's concept of bedload transport where resting periods are longer than motion periods, there should be two diffusion regimes when the distributions are light-tailed.

\subsection{starting in motion}

Now I'll try using the opposite initial condition (the one chosen by \citet{Lisle1998}): $\theta_+ = 1$ and $\theta_- = 0$.
In this case
\be \tilde{p}(\eta,s) = \frac{k+s}{v(k_-+s)\eta + (k+s)s},\ee
and a first inverse transform gives
\be p(x,s) = \frac{k+s}{v(k_-+s)} \exp\Big[-\frac{(k+s)s}{v(k_-+s)}x\Big],\ee
which is the same as the other case but without a delta function term at $x=0$.
This can be manipulated to 
\begin{align} p(x,t) &= \El^{-1} \Big\{ \frac{k+s}{v(k_-+s)} \exp\Big[-\frac{(k+s)s}{v(k_-+s)}x\Big] ; t\Big\} \\
&=  e^{-k_- t}\El^{-1} \Big\{ \frac{k_++s}{vs} \exp\Big[-\frac{(k_++s)(s-k_-)}{vs}x\Big] ; t\Big\} \\
&= e^{-k_- t -(k_+-k_-)x/v}\El^{-1} \Big\{ \frac{k_++s}{vs} \exp\Big[\frac{k_-k_+}{vs}x - \frac{xs}{v}\Big] ; t\Big\}\\
&= e^{-k_- t -(k_+-k_-)x/v}\El^{-1} \Big\{ \frac{k_++s}{vs} \exp\Big[\frac{k_-k_+}{vs}x\Big] ; t-x/v\Big\} \\
&=  e^{-k_- t -(k_+-k_-)x/v} \Big[ \El^{-1}  \Big\{ \frac{k_+}{vs} \exp\Big[\frac{k_-k_+}{vs}x\Big];t-x/v \Big\} + \El^{-1}  \Big\{ \frac{1}{v} \exp\Big[\frac{k_-k_+}{vs}x\Big];t-x/v \Big\} \Big] \\
&=  e^{-k_- t -(k_+-k_-)x/v} \Big[\frac{k_+}{v} I_0\Big(2\sqrt{\frac{k_-k_+ x}{v}\big(t-\frac{x}{v}\big)}\Big) + \frac{1}{v}\El^{-1}\Big\{  \exp\Big[\frac{k_-k_+}{vs}x\Big] -1;t-x/v \Big\} + \frac{1}{v}\delta(t-x/v) \Big] \\ 
&=  e^{-k_- t -(k_+-k_-)x/v} \Big[\frac{k_+}{v} I_0\Big(2\sqrt{\frac{k_-k_+ x}{v}\big(t-\frac{x}{v}\big)}\Big) + \frac{1}{v}\sqrt{\frac{k_- k_+ x}{v (t-x/v)}}I_1\Big(2\sqrt{\frac{k_-k_+ x}{v}\big(t-\frac{x}{v}\big)}\Big) + \frac{1}{v}\delta(t-x/v) \Big].
\end{align}
A key property here was $e^{-ax}f(x) = \El^{-1}\{f(s+a);x\}$, and those in the appendix.
This type of math is not easy for me.
In the non-dimensional variables this becomes
\be p(\xi,\tau) = e^{-\tau-\xi}\Big[ \frac{k_+}{v} I_0(2\sqrt{\xi\tau}) + \frac{k_-}{v}\sqrt{\frac{\xi}{\tau}}I_1(2\sqrt{\xi\tau}) + \frac{k_-}{v} \delta(\tau)\Big].\ee
This appears totally aligned with \citet{Lisle1998}.
\subsubsection{moments having started in motion}

In this case the mean is
\be  \frac{k^2}{v}\bra x(t) \ket = k_- kt + k_+(1-e^{-kt}).\ee
This result seems to make sense and agree with the asymptotic result of \citet{Lisle1998}, especially since it has a constant term associated with starting in motion (so a displacement of order $v/k_+$ is guaranteed).
The second moment is
\be
\frac{k^4}{2v^2}\bra x^2 \ket = k_-^2\frac{(kt)^2}{2} + k_-k_+\{2kt -2 + 2e^{-kt}\} + k_+^2\{1-(1+kt)e^{-kt}\}.
\ee
I checked this result numerically.
Performing more manipulations on the mean obtains
\be\frac{k^4}{2v^2} \bra x\ket^2 = k_-^2 \frac{(kt)^2}{2} + k_-k_+\{kt - kte^{-kt}\} +  k_+^2\{\frac{1}{2} - e^{-kt} + \frac{1}{2}e^{-2kt}\}   ,\ee
so the variance is
\be \frac{k^4}{2v^2} \sigma_x^2(t) = k_- k_+ \{kt -2 + (2 + kt)e^{-kt}\} + k_+^2\{\frac{1}{2} -kt e^{-kt} - \frac{1}{2}e^{-2kt}\}.\ee
This variance describes short term ballistic diffusion $\sigma_x^2 \propto t^3$ and long term normal diffusion.
When the mean motion time is larger than the mean resting time, the cross-over is sharp.
When the mean motion time is smaller than the mean resting time,
there is a sub-diffusive cross-over zone.
So in the zone envisioned by Einstein when motions are relatively short compared to rests, there is sharp cross-over between $t^3$ super-diffusion and normal diffusion.
 
\section{A new generalization: Randomly stopped Lisle process}

Consider the choice $\psi_1(t) = k_1e^{-k_1t}$, $f_1(x,t)=\delta(x)$, $\psi_2(t) = k_2e^{-k_2t}$, and 
\be f_2(x,t|T) = \delta(x-vt)\Theta(T-t) + \delta(x)\Theta(t-T).\ee
This describes a \textit{randomly stopped} variant of the Lisle process.
When $t>T$, the motion state becomes a second rest state: the motion is turned off.
In this case, $g_1(\eta,s) = \frac{k_1}{k_1+s}$ and $G_1(\eta,s) = g_1(\eta,s)/k_1$ as before, while
\be g_2(\eta,s|T) = \frac{k_2}{k_2+s}e^{-(k_2+s)T} + \frac{k_2}{k_2 + \eta v + s}\Big(1-e^{-(k_2 + \eta v + s)T}\Big)\ee
and $G_2(\eta,s|T) = g_2(\eta,s|T)/k_2$.
You can maybe solve this conditional to $T$ to obtain $p(x,t|T)$.
Then inputting a distribution for the trapping time $T$, the over-all distribution will be $p(x,t) = \int dT p(x,t|T)f(T)$.

Assuming the walker starts at rest the double transformed probability is
\be \tilde{p}(\eta,s) = \ee


\section*{Appendix: Laplace transforms}
This is just a reference of useful Laplace transforms for these types of studies.
\be \El^{-1}\Big\{p^{-2}(p+a)^{-1};x\Big\} = \frac{1}{a^2}(e^{-ax}+ax-1),\ee
\citep[][2.1.2.33]{Prudnikov1986};
\be \El^{-1}\Big\{p^{-2}(p+a)^{-2};x\Big\} = \frac{1}{a^3}[ax - 2 + (ax+2)e^{-ax}],\ee
\citep[][2.1.2.49]{Prudnikov1986};
\be \El^{-1}\Big\{p^{-3}(p+a)^{-2};x\Big\} = \frac{1}{a^4}\Big[\frac{(ax)^2}{2} - 2ax - (ax+3)e^{-ax} + 3\Big], \ee
derived from the previous result using the differentiation property;
\be \El^{-1}\Big\{p^{-1}(p+a)^{-2};x\Big\} = \frac{1}{a^2}\Big(1 -(1+ax)e^{-ax}\Big),\ee
\citep[][2.1.2.47]{Prudnikov1986};
\be \El^{-1}\Big\{p^{-1}(p+a)^{-1};x\Big\} = \frac{1}{a}(1-e^{-ax}),\ee
\citep[][2.1.2.31]{Prudnikov1986};
\be\El^{-1} \{e^{as}\tilde{f}(s);x\} = \El^{-1}\{\tilde{f}(s);x+a\},\ee
the shifting property;
\be \El^{-1}\big\{\frac{1}{s^\nu}\exp(a/s);t\} = \Big(\frac{t}{a}\Big)^{(\nu-1)/2}I_{\nu-1}\big(2\sqrt{a t}\big), \ee
valid for $\nu>1$ from \citep[][2.2.2.1]{Prudnikov1986};
\be \El^{-1}\{e^{a/p}-1;x\} = \sqrt{\frac{a}{x}}I_1(2\sqrt{ax}),\ee
and \citep[][2.2.2.8]{Prudnikov1986}.
All of these Laplace transforms are verified from Wolfram Alpha so I expect no typos.
Finally,
\be \El\Big\{\frac{a}{bs+c};s\Big\} = \frac{a}{b}e^{-cx/b}\ee
and
\be \El\Big\{\frac{as}{bs+c};s\Big\} = \frac{a}{b}\Big[\delta(x) - \frac{c}{b}e^{-cx/b}\Big].\ee
\bibliography{biblio}
\end{document}



