%\documentclass[draft]{agujournal2018}
\documentclass[]{agujournal2018}
\usepackage{apacite}
\usepackage{url}
\usepackage{lineno}
%\linenumbers
\draftfalse
\journalname{Geophysical Research Letters}

%custom packages
\usepackage{amsmath,amssymb,amsfonts,amsthm}
\usepackage{comment}
\usepackage{booktabs}
% custom commands
\newcommand\be{\begin{equation}}
\newcommand\ee{\end{equation}} 
\newcommand\bra{\langle}
\newcommand\ket{\rangle}
\newcommand\om{\omega}
\newcommand\tom{\tilde{\omega}}
\newcommand\tg{\tilde{g}}
\newcommand\tp{\tilde{p}}
\newcommand\tG{\tilde{G}}
\newcommand\El{\mathcal{L}}

\begin{document}

\title{Back to Einstein: how to include trapping processes in fluvial diffusion models?}

\authors{James K. Pierce \affil{1}and Marwan A. Hassan\affil{1}}
\affiliation{1}{Department of Geography \\University of British Columbia}
\correspondingauthor{James Kevin Pierce}{kpierce@alumni.ubc.ca}

\begin{keypoints}
\item We generalize the bedload diffusion model of Hans Albert Einstein to include the duration of sediment motion and the possibility of trapping.
\item This derives three stages of bedload diffusion and unambiguously attributes physical mechanisms to each stage.
\end{keypoints}

\begin{abstract}
One approach to predict geomorphic change in rivers is to upscale from the motions of individual sediment grains. A difficulty with this approach is the wide range of individual motion characteristics that imply sediment diffusion, or the spreading out of grains through time. A more acute difficulty is that these motion characteristics apparently vary across temporal and spatial scales, implying multiple stages of sediment diffusion. We relate this multi-stage diffusion to within-channel trapping processes that impede the motions of individual grains. Grains can become stranded on high bars during floods, or they can become buried within the sedimentary bed, but these processes take a relatively long time to occur. Drawing on ideas from condensed matter physics and cellular biology, we describe the finite-velocity motions of individual grains within channels as random walkers subject to trapping. This derives three stages of bedload diffusion and clarifies the underlying mechanism, providing a tool to link between scales.
\end{abstract}

\section{Introduction}
% what is problem and why does it matter
% what do we know about it 
% how do we approach it

Models to predict the movement patterns of individual bedload sediment grains through rivers have been studied since at least \citet{Einstein1937}.
Einstein originally used a random walk concept to describe these patterns statistically, and he applied his model to experimental data from a series of flume experiments.
Individual movements are ultimately responsible for changes in the spatial organization of river channels \citep{Hassan2017}, so predictive models of these patterns could benefit a vast set of environmental considerations, ranging from aquatic habitat restoration \citep{Hauer2016} to the management of contaminated streams \citep{Macklin2006} and artificial reservoirs \citep{Schleiss2016}.
Unfortunately, Einstein's approach does not provide a definitive solution to this problem, although its essential concepts lie at the base of the majority of contemporary approaches.
The essential issue is that Einstein's original measurements on bedload transport characteristics are now known to be relevant only on a certain observation timescale \citep{Nikora2001a}.
Since \citet{Einstein1937}, details of bedload transport have come to light which are not accessible by his measurement techniques.
There is a need for new models to account for these new details and predict the movements of individual grains.

When bedload grains transport downstream, each grain is imparted a unique sequence of forces by turbulent and steady components of the flow \citep{} and collisions with other moving and stationary grains \citep{Gordon1972}. 
As a result, grains spread apart from one another as they transport downstream: a phenomenon called diffusion.
Diffusion is characterized by the variance of particle position $\sigma_x^2(t)$ \citep{Furbish2017}.
An extreme diversity of transport phenomena show diffusion: it is not limited to the movement of grains within river channels, and it has been deeply studied in geology \citep{Berkowitz2006}, chemistry \citep{Shugard1976}, biology \citep{Sokolov2012}, hydrology \citep{Yang2019}, and many other contexts.
The classic examples are pollen grains diffusing in response to molecular collisions while suspended in water, as first described mathematically by Hans Albert Einstein's father \citep{Einstein1905} and sand within a pipe flow \citep{Taylor1920}.
In these cases, individual particles (pollen, sand, gravel) spread apart at a rate proportional to the time: $\sigma_x^2 \propto t$. Such diffusion is said to be normal.
This name connotes the idea that this diffusion is somehow particularly characteristic of natural phenomena.

In contrast to this nomenclature, researchers of transport phenomena across the physical sciences have realized that normal diffusion is far from ubiquitous \citep{Shlesinger1993}.
When diffusion is not normal, it is called anomalous, a term defined by a variance scaling $\sigma_x^2 \propto t^\gamma$, where $\gamma \neq 1$. 
Some examples of anomalous diffusion include transport of nutrients through lipid bilayers \citep[e.g.][]{Jeon2012,Molina-Garcia2018}, contaminants through groundwater aquifers \citep[e.g.][]{AaraoReis2014,Yang2019}, charge carriers through solids \citep[e.g.][]{Scher1973}, and, indeed, sediment grains through rivers \citep{Hassan2017,Phillips2013,Martin2012,Bradley2017}.
In this work, we revisit the approach of Einstein to bear on the problem of multiple-stage diffusion.
We draw upon methods developed in biology and condensed matter physics to form a description of anomalous and multi-stage diffusion which is directly linked to the original formulation of Einstein.
There is a need to review \citet{Wu2019, Zhang2012, Hassan2017, Phillips2013, Martin2012} and write something meaningful involving them, then rewrite this introduction because it isn't good.
Anyway, here's the model.


\section{Bedload diffusion with trapping}

\subsection{multi-state random walk}
% explain two-state random walk
We use the formalism of multi-state random walks to include motion, rest, and burial processes into a model of bedload diffusion.
Multi-state random walks were first formalized by \citet{Weiss1976} and are carefully reviewed in \citet{Weiss1994}.
The transport of any individual bedload grain through a river channel is modeled as the result of three distinct states: motion, rest, and burial.
We label these as $i=2$ (motion), $i=1$ (rest), and $i=0$ (burial).
We use a three-state random walk to study bedload diffusion.
In this model, transitions between states are random, and the transport properties of particles within each state are characterized statistically.

% describe meaning of sojourns and g_i/G_i/theta_i
When a particle enters a state $i$ at some time $t_0$ and position $x_0$, then leaves a state at some other time $t_1$ and position $x_1$, we say that the particle has completed a sojourn $i$. The joint probability density for a complete sojourn through the state $i$ of time $\tau = t_1-t_0$ and displacement $\xi = x_1-x_0$ is denoted $g_i(\xi,\tau).$ Similarly, we can consider incomplete sojourns. If a particle begins a sojourn in the state $i$ at $(t_0,x_0)$ and the sojourn is still on-going, the joint probability density to find the particle at $(x_1,t_1)$ is $G_i(\xi,\tau)$. The $g_i$ and $G_i$ can be further decomposed when time and space components of the motion are independent \citep{Weiss1994}.
We refer to $g_i$ and $G_i$ as propagators, since they move probability through space-time.

% discuss two-stage derivation of weiss
Our target is the probability distribution $p(x,t)$ to find a particle at $x,t$ if we know it started at $(x,t)=(0,0)$, i.e.,  $p(x,0)=\delta(x).$
Hitting this target has three main steps.
First, we introduce and solve for a set of quantities associated with transitions from one state to another.
Second, we use these quantities to solve for the probabilities that a particle is in state $i$ having position $x$ at time $t$.
The third step is trivial: we sum the former objects over all states to derive the probability that a particle is in any state at $(x,t)$.

% derive omegas
Now we begin the first stage of the derivation.
Tracers at rest may be trapped by burial.
We consider burial to be permanent \citep[e.g.][]{Wu2019}, and we assume resting grains may be buried with constant probability per unit time $\kappa$.
From this assumption, the probability that a grain is not trapped after a time $t$ at rest is given by a survival probability $\Phi(t) = e^{-\kappa t}$. Likewise, the probability that it is trapped after resting for a time $t$ is the complement $1-\Phi(t)$.
We introduce $\omega_{1T}(x,t)$, $\omega_{1F}(x,t)$, and $\omega_2(x,t)$ as the joint probabilities to find a grain at $(x,t)$ having just completed a sojourn.
The subscript ${1T}$ ("trapped") denotes the completion of a rest sojourn due to trapping, while $1F$ ("free") denotes the completion of a rest sojourn due to movement.
Similarly, the subscript $2$ denotes the completion of a movement sojourn due to the onset of resting.
Using an argument similar to \citet{Weiss1994}, we can write integral equations to link these $\omega$'s. 
\begin{align}
\om_{1T}(x,t) &= \theta_1\big[1-\Phi(t)\big]g_1(x,t) + \int_0^x dx' \int_0^t dt' \om_2(x',t')\big[1-\Phi(t-t')\big]g_1(x-x',t-t')\label{eq:x}\\
\om_{1F}(x,t) &= \theta_1\Phi(t)g_1(x,t) + \int_0^x dx' \int_0^t dt' \om_2(x',t') \Phi(t-t') g_1(x-x',t-t')\\
\om_2(x,t) &= \theta_2 g_2(x,t) + \int_0^x dx' \int_0^t dt' \om_{1F}(x',t')g_2(x-x',t-t') \\
\end{align}
$\theta_1$ and $\theta_2$ are the initial ($t=0$) probabilities for particles to have started at rest and motion.
These equations all have the same structure: consider the first to understand their foundational reasoning.
$\omega_{1T}(x,t)$ describes the probability that a sojourn in the state $1$ ends due to trapping at $(x,t)$. The first term states that the particle started at $(x,t)=(0,0)$ (with probability $\theta_1$) in the $i=1$ state, propagated a distance $x$ and a time $t$ (with probability $g_1(x,t)$), was trapped (with probability $1-\Phi(t)$), and is now at $x,t$. 
The second term describes a second possibility.
In this case, the particle was in a motion sojourn which ended at $x',t'$, at which point it came to rest, it propagated from $x',t'$ to $x,t$ at rest (with probability $g_1(x-x',t-t')$, and was trapped during this sojourn (with probability $\Phi(t-t')$).
The other equations can be reasoned similarly, in a manner analogous to \citet{Weiss1994}.
Once the propagators are specified, we can solve these equations for the $\omega$'s. This completes the first stage of the derivation.

% derive p's
The second stage of our derivation involves the joint probabilities of being in state regardless of whether a sojourn has just completed. These are denoted by  $p_0(x,t)$ (trapped), $p_1(x,t)$ (rest), and $p_2(x,t)$ (motion), and they involve the $\omega$'s for their definition:
\begin{align}
p_0(x,t) &= \int_0^t dt' \omega_{1T}(x,t-t')\\
p_1(x,t) &= \theta_1 G_1(x,t) + \int_0^x dx' \int_0^t dt' \omega_2(x',t')G_1(x-x',t-t')\\
p_2(x,t) &= \theta_2 G_2(x,t) + \int_0^x dx' \int_0^t dt' \omega_{1F}(x',t')G_2(x-x',t-t').\label{eq:z}
\end{align}
The reasoning here is totally analogous, except we use the propagators for incomplete sojourns.
These can be solved once the propagators are specified and the $\omega$'s are known.
The third stage of the derivation is to form the total probability for a particle to be found at $(x,t)$.
This is simply 
\be p(x,t) = p_0(x,t) + p_1(x,t) + p_2(x,t)\ee
Now we turn to the definition of the propagators and solution of the resulting model defined by (\ref{eq:x}-\ref{eq:z}).


\subsection{Specification of Propagators and solution of model}
% choice of propagators
We consider sojourns in the rest state to occur for an exponentially distributed time interval, given by the distribution $\psi_1(t) = k_1 e^{-k_1t}.$
The probability that a sojourn in this state lasts for at least the time $t$ is then given by $\Psi_1(t) = \int_t^\infty \psi_1(t)dt = e^{-k_1 t}$.
Since resting particles do not move, the probability of finding the particle at its starting position is $1$, while the probability of finding it anywhere else is zero.
Hence the resting propagator for a complete sojourn is $g_1(x,t) = \delta(x)\psi_1(t),$ or 
\be g_1(x,t) = \delta(x)k_1e^{-k_1t}.\label{eq:prop1} \ee
Likewise, the resting propagator for an incomplete sojourn is $G_1(x,t) = \delta(x)e^{-k_1t} = g_1(x,t)/k_1.$
We consider motions to occur with a constant velocity $v$ and to last for an exponentially distributed duration given by $\psi_2(t) = k_2 e^{-k_2t}.$
Since motions are deterministic, the probability to find a particle at position $x$ in a sojourn is $\delta(x-vt)$, and the complete propagator is 
\be g_2(x,t) = \delta(x-vt)k_2e^{-k_2t},\label{eq:prop2}\ee
while the incomplete propagator is $G_2(x,t) = g_2(x,t)/k_2$ as before.

% distribution functions and moments in laplace space
Having defined the propagators, we can set out to solve (\ref{eq:x}-\ref{eq:z}) and understand the diffusion of bedload with a finite motion interval and when subject to trapping by burial.
The convolution structure of (\ref{eq:x}-\ref{eq:z}) presents a formidable problem.
Luckily, we have the device of Laplace transforms.
These project integro-differential equations into an alternate space in which convolutions are unraveled \citep[e.g.][]{Arfken1985}.
The double Laplace transform of a joint probability distribution $p(x,t)$ is defined by 
\be \tilde{p}(\eta,s) = \int_0^\infty dx e^{-\eta x}\int_0^\infty dt e^{-st} p(x,t) \label{eq:doubletransform}\ee
The Laplace-transformed moments of $x$ are linked to derivatives of the double-transformed distribution \citep[e.g.][]{Weeks1998}.
From (\ref{eq:doubletransform}) it's clear that
\be \bra \tilde{x}(s)^k \ket = (-)^k\partial_\eta^k p(\eta,s)\Big|_{\eta=0}.\ee
The operator $\bra \circ \ket$ denotes the ensemble average \citep[e.g.][]{Kittel1958}.
This means we can compute the variance of position as $\sigma_x^2(t) = \bra x^2 \ket - \bra x \ket^2 = \El^{-1} \Big\{\bra\tilde{x}^2 \ket;t\Big\} - \El^{-1} \Big\{\bra\tilde{x} \ket;t\Big\}$, where $\El^{-1}$ denotes the inverse Laplace transform \citep[e.g.][]{Arfken1985}.


% solution for case theta_1=1: distribution function
Using the propagators (\ref{eq:prop1}-\ref{eq:prop2}) and this transform calculus, the distribution $p(x,t)$, the moments $\bra x \ket$ and $\bra x^2 \ket$, and ultimately the variance of position $\sigma_x^2(t)$ are derived in appendix \ref{sec:appendix}. Using the shorthand $\xi = k_2 x/v$ and $\tau = k_1(t-x/v)$ \citep[c.f.][]{Lisle1998} and assuming all particles start from motion ($\theta_1=1$), the distribution function is 
\begin{multline}
p(x,t) = e^{-(\kappa + k_1)\tau/k_1-\xi}\mathcal{H}(\tau)\mathcal{H}(\xi)\Bigg[\frac{k_1}{v}\delta(\tau) + \frac{k_1}{v} \sqrt{\frac{\xi}{\tau}}\mathcal{I}_1(2\sqrt{\xi\tau}) + \frac{k_2}{v} \mathcal{I}_0(2\sqrt{\xi\tau})\Bigg]\\
+ \kappa \frac{k_2}{v(\kappa+k_1)}\mathcal{H}(\tau)\mathcal{H}(\xi)e^{-\xi}\mathcal{P}_1\big(\kappa\xi/(\kappa+k_1), (\kappa+k_1)\tau/k_1\big).
\label{eq:pdf}
\end{multline}
The $\mathcal{I}_\nu$ are modified Bessel functions of the first kind and $\mathcal{P}_1$ is a (complementary) Marcum-Q function defined by $\mathcal{P}_1(x,y) = \int_0^y e^{-z-x}\mathcal{I}_0(2\sqrt{xz})dz. $ \citep{Marcum1960,Temme1996}. $\mathcal{H}(x)$ is the Heaviside step function and we use the convention $\mathcal{H}(0)=1$.
This distribution is depicted in figure \ref{fig:pdfs}.

% figure showing distribution functon
\begin{figure}
	\includegraphics[width=\linewidth,keepaspectratio]{./figures/pdf-plot-edit.png}
	\caption{Joint distributions of a tracer being found at $x$ $t$ are impeded by the trapping process. Panel (a) shows the \citet{Lisle1998} model, and panel (b) shows the the distribution \ref{eq:pdf} which results from a trapping process occurring at rate $\kappa$. Cross-comparison of both panels shows that trapping redistributes probability to smaller values of $x$, and this redistribution becomes more important for larger $t$.}
	\label{fig:pdfs}
\end{figure}


% solution for theta_1=1: moments

For the same initial conditions $\theta_1=1$ the first two moments are
\be \bra x(t) \ket = A_1 e^{(b-a)t}+B_1e^{-(a+b)t}+C_1 \label{eq:mean}\ee
\be \bra x^2(t) \ket = A_2(t)e^{(b-a)t}+B_2(t)e^{-(a+b)t}+C_2. \label{eq:second}\ee
The $A_i$ and $B_i$ are polynomials tabulated in (\ref{table:params}).
In terms of these moments, the variance is
\be \sigma_x^2(t) = A(t)e^{(b-a)t} + B(t)e^{-(a+b)t} + C(t) \label{eq:var}\ee
We have made no approximation to derive this expression.
It represents diffusion of bedload tracers subjected to burial and when the finite period of motion is accounted for. \citet{Lisle1998}
\begin{table}[!h]
	\centering
	\caption{Polynomials and transcendental functions used in the expressions of the mean (\ref{eq:mean}), second moment (\ref{eq:second}) and variance (\ref{eq:var}) of bedload tracers.}
	\label{table:params}
	\begin{tabular}{c}
		\toprule
		$A_1 = \frac{v}{2b}\big[1+\frac{\kappa+k_1}{b-a}\big]$ \\
		$B_1 = -\frac{v}{2b}\big[1-\frac{\kappa+k_1}{a+b}\big]$ \\
		$C_1 =  -\frac{v}{2b}\big[\frac{\kappa+k_1}{b-a}+\frac{\kappa+k_1}{a+b}\big]$\\
		$A_2(t)=\frac{v^2}{2b^3}\Big[b+(b-a)[bt-1]+2(\kappa+k_1)[bt-1] + \frac{(\kappa+k_1)^2}{(a-b)^2}[-abt+a+b(bt-2)]\Big] $\\
		$B_2(t) = \frac{v^2}{2b^3}\Big[b-(a+b)[bt+1]+2(\kappa+k_1)[bt+1] - \frac{(\kappa+k_1)^2}{(a+b)^2}[bt(a+b)+a+2b]\Big] $\\
		$C_2(t) = \frac{v^2}{2b^3}(\kappa+k_1)^2\Big[\frac{a+2b}{(a+b)^2}+\frac{-a+2b}{(a-b)^2}\Big]$\\
		$A(t) = A_2(t)-2A_1C_1 + A_1^2\exp[(b-a)t]$\\
		$B(t) = B_2(t)-2B_1C_1 + B_1^2\exp[-(a+b)t]$\\
		$C(t) = C_2-C_1^2+2A_1B_1\exp[-2at]$\\
		\bottomrule
	\end{tabular}
\end{table}




\section{Discussion: new findings and foundational links}


\subsection{bedload diffusion}
% plot variance
A plot of $\sigma_x^2(t)$ is shown in figure \ref{fig:var} for the case that motions are short relative to rests, and trapping occurs with characteristic timescale $1/\kappa$ which is in turn much shorter than the resting period.
That is, for the case that $1/k_2 \ll 1/k_1 \ll 1/\kappa$.
\begin{figure}[t]
	\includegraphics[width=\linewidth,keepaspectratio]{./figures/diffusion.png}
	\caption{The variance of tracer position exhibits four distinct scaling regions as time increases: local, intermediate, global, and finally a non-diffusive range characterized by the eventual trapping of all grains.
	Local and global ranges show super-diffusion $\sigma_x^2 \propto t^3$ while the intermediate range shows normal diffusion. These conclusions hold only for $\kappa \ll k_1 \ll k_2$, meaning motion intervals are generally much shorter than resting intervals, which are in turn are generally much smaller than the time required for resting particles to become buried.}
	\label{fig:var}
\end{figure}
% discuss 3+1 stages of diffusion
For this case there are three stages of diffusion which we associate with the local, intermediate, and global ranges put forth by \citet{Nikora2001a}. There is also a late-stage period of no transport, when the distance between tracers is fixed.
Figure \ref{fig:var} suggests the representation
\be \sigma_x^2 \sim
\begin{cases}
t^{\gamma_\text{local}}, & t\ll \tau_\text{local},\\
t, & \tau_\text{local} \ll t \ll \tau_\text{inter}, \\
t^{\gamma_\text{global}}, & \tau_\text{inter} \ll t \ll \tau_\text{global}, \\
\text{const.}, & \tau_\text{global} \ll  t
\end{cases}\ee
where $\tau_\text{local}$, $\tau_\text{inter}$, and $\tau_\text{global}$ are cross-over times between the diffusion regimes.
$\gamma_\text{local}$ and $\gamma_\text{global}$ are exponents characterizing the local and global range super-diffusion.

% discuss ballistic/normal/ballistic
For the case $1/k_2 \ll 1/k_1 \ll 1/\kappa$ and the initial condition $\theta_1$ the exponents $\gamma_\text{local} \approx 3$ and $\gamma_\text{global} \approx 3$.
% highlight the ranges of cross-over zones and describe physically why
These regions of constant scaling are divided by cross-over zones having finite widths.
Within these zones,the diffusion is not described by a constant scaling law.
The boundaries of these zones are related to the dominant timescales of the transport process.
We identify four key timescales.
These are: (1) the mean time spent in motion, $1/k_2$; (2) the mean time spent at rest, $1/k_1$; (3) the mean time required for a resting grain to trap, $\tau_\text{trap}=1/\kappa$; and (4) the mean time required for a grain switching between motion and rest to trap, $\big(\kappa \frac{k_2}{k_1+k_2}\big)^{-1}$.
To derive the 4th timescale we reason if grain cycles through motion and rest states without trapping, the mean time of a single cycle is $1/k_1 + 1/k_2$, while the mean time spent at rest is $1/k_1$. This means $\frac{1/k_1}{1/k_1 + 1/k_2} = \frac{k_2}{k'}$ is the fraction of time spent at rest \citep[c.f.][]{Ancey2006}. Using this ratio, there is an effective trapping rate $\frac{\kappa k_2}{k'}$ of grains cycling through rest and motion, which supports the 4th characteristic timescale $\frac{k'}{\kappa k_2}$.
The cross-over times $\tau_\text{local}$, $\tau_\text{inter}$, and $\tau_\text{global}$ are geometric means of these four timescales.
We discern $\tau_\text{local} = \sqrt{\frac{1}{k_1}\frac{1}{k_2}}$, $\tau_\text{global} = \sqrt{\frac{1}{\kappa} \frac{k'}{\kappa k_2}}$.
A further geometric mean gives $\tau_\text{inter} = \sqrt{\tau_\text{local}\tau_\text{global}}$.
These timescales are the vertical lines plotted in figure \ref{fig:var}.

% discuss other possibilities
These results pertain to the conditions $1/k_2 \ll 1/k_1 \ll 1/\kappa$ and the initial condition $\theta_1$.
The assumption that rests are much longer than motions was introduced by \citet{Einstein1937} and will be true for the intermittent stage of bedload motion \citep[e.g.][]{Nikora2001,Heyman2016} where the motion does not resemble a sheet flow \citep{Frey2014}.
We cannot imagine that the characteristic timescale of trapping due to burial $1/\kappa$ would exceed the characteristic resting timescale $1/k_1$, so we consider this constraint always satisfied.
Therefore we need to discern the phenomena of the model for other initial conditions, where $\theta_1 $ and $\theta_2$ are arbitrary; and for the case that $k_1$ and $k_2$ are not well-separated, so that bedload rests are not necessarily much longer than motions.
In these cases, the diffusion characteristics are still described by (\ref{eq:var}), since it is an exact result, but the three-stage diffusion depicted in figure \ref{fig:var} is not necessarily retained.

% effect of initial conditions
The effect of initial conditions on the diffusion phenomena can be surmised using the approach of Tauberian theorems, which are a device to provide small (or large) time asymptotic behavior of a quantity which is known in Laplace space \citep[e.g.][]{Weiss1994}.
We reason that initial conditions cannot affect the intermediate or global range diffusion apart from shifting the $\tau_\text{local}$, since its memory cannot be retained in our model.
We note our model is Markovian by virtue of the choice of exponential propagators \citep{Weiss1994}, meaning it can only have short-term memory.
We show in Appendix \ref{sec:appendix2} that the local range diffusion for arbitrary initial conditions is 
\be \sigma_x^2 \sim v^2 \theta_1 \theta_2 t^2  + \frac{1}{3}(\theta_1 k_1 + \theta_2 k_2)v^2t^3\ee
This is an interesting equation since it encodes a trade-off between $t^2$ and $t^3$ super-diffusion as initial conditions are varied.
If the initial conditions are "pure", meaning all tracers were started at rest or in motion, so one of $\theta_i$ is zero, the local-range diffusion scales as $\sigma_x \sim t^3.$
If the initial conditions are mixed, so both $\theta_i$ are non-zero, diffusion scales as $t^2$, which is still super-diffusive, but with a slower rate of spreading through time.

\subsection{links to earlier works}

% link to lisle 1998
\citet{Lisle1998} generalized the theory of \citet{Einstein1937} to describe the stochastic transport of soil particles under rainfall.
This model includes an exponentially distributed period of motion having velocity $v$ and exponentially distributed resting periods.
Therefore our model is equivalent to that of \citet{Lisle1998} in the limit that the trapping process is turned off: $\kappa \rightarrow 0$.
Taking this limit in (\ref{eq:var}) provides a simpler expression with only two stages of bedload diffusion: a local ballistic range and normal diffusion in the intermediate range. The global range phenomena are not captured since trapping processes are neglected.

% link to Eintsein1937
\citet{Einstein1937} considered steps to be instantaneous, and he characterized them by an exponential step distance distribution.
To access this model from ours, a more careful type of limit is necessary, which reminds one of the limits often used to take continuum limits of lattice theories in physics \citep[e.g.][]{Goldstein1980, Weiss1994}.
This involves sending the mean motion time $1/k_2 \rightarrow 0 $ (equivalent to $k_2 \rightarrow \infty$) while holding the mean step distance $l = v/k_2$ constant.
Denoting the mean resting time by $\tau = 1/k_1$, this results in a bedload variance
\be f=ma \ee
consistent with \citet{Einstein1937}.
This foundational model expresses only single-stage normal diffusion which is associated with the intermediate range. 
The local and global ranges are not captured since the interval of motion and sediment trapping processes are neglected.

% link to Wu2019
More recently, \citet{Wu2019} modeled the diffusion of tracers undergoing burial by assuming grains move in instantaneous steps and may bury with a constant rate while at rest.
Our model includes this in the limit that motions become instantaneous while $\kappa$ is left unconstrained: $k_2 \rightarrow \infty$ as $l = v/k_2$ is held constant and $\kappa \neq 0$.
In this case, (\ref{eq:var}) becomes
\be f=ma \ee
This describes two stages of bedload diffusion as discriminated by \citet{Wu2019}.
There is an intermediate range normal diffusion and a global range super-diffusion.
The local range is not resolved since motion times were neglected.

% discuss limitations and unifying role of this work
Although our model captures three stages of bedload diffusion and unifies a set of earlier works under one mathematical formalism, there are several limitations worth noting.
These constrain its applicability and provide directions for future research.
The major limitation of this work, and, for that matter, the foundational works it builds upon, is that transport characteristics ($k_1, k_2, v, \text{ and }\kappa$, in our case) of sediment grains are considered independent of space and time.
In reality, river channels are often in a state of active adjustment to disturbances in sediment supply regime and variations in hydraulic flow \citep{Church2017}. 
The transport characteristics of individual grains are deeply linked to the morphology of river channels \citep{Hassan2017}, and therefore to morphodynamics as well \citep[e.g.][]{Dhont2018}.
In addition, the (local range) velocities at which grains travel vary from one grain to the next \citep{Fathel2015, Heyman2016} and through time \citep{Fan2014, Ancey2014} due to turbulence \citep{Celik2014} and the unpredictable nature of bedload collisions with moving \citep{Lee2002} and stationary grains \citep{Gordon1972}.
In summary, bedload transport happens in a spatially and temporally variable environment, so any characteristics of transport necessarily vary in time and space.
To our knowledge, no existing theories have provided a concrete approach to account for this physical problem, and ours is no exception.
To overcome this limitation, is a need to delve deeply into the theory of random phenomena and to applications beyond geophysics.
Surely, there are approaches worth incorporating from other sciences \citep[e.g.][]{Kutner2017}.

\subsection{Geomorphic scaling / scope of conclusions}
% purpose of diffusion understanding
Sediment diffusion in river channels is an important consideration because the movement patterns of individual grains are ultimately responsible for geomorphic change \citep{Hassan2017} and solid contaminant transport through river channels \citep{Malmon2005, Macklin2006}.
This diffusion is anomalous, so any model that describes is also broadly relevant in contemporary science, since anomalous diffusion processes constitute significant difficulties in biology \citep[e.g.][]{Sokolov2012}, geology \citep[e.g.][]{Berkowitz2006}, physics \citep[e.g.][]{Metzler2000}, and chemistry \citep[e.g.][]{Metzler2014}, just as in geomorphology \citep[e.g.][]{Voller2010}.


% issue with linking scales due to scale-dependence of sediment xport
In all of these considerations, the key issue is that anomalous diffusion introduces a scale dependence to the phenomena under study.
In sediment transport, this means the time-scale of observation can affect the measurement of transport characteristics, and descriptions of sediment transport phenomena are necessarily scale dependent.
Indeed, this has been noted in a variety of experiments \citep{Singh2009,Saletti2015,Campagnol2012}.
However, I need to learn more about it to write about it meaningfully.

% we have shown a solution to this deriving all three stages of bedload transport using light-tailed distributions
Although previous authors have derived three-stages of bedload diffusion using models that are equivalent to the inclusion of heavy-tailed sojourn times in a random-walk theory such as ours \citep[e.g.][]{Zhang2012}, and some authors have derived two stages of bedload diffusion \citep[e.g.][]{Wu2019}, we believe we are the first to construct a model of bedload diffusion which encompasses all three stages of bedload diffusion.
We have done this by including trapping processes and finite motion periods into an \citet{Einstein1937}-type model.
In this process, contemporary tools such as the mathematical formalism for continuous time random walks founded by \citet{Montroll1965} and generalized by \citet{Weiss1976} have been essential.


\section{Conclusion}
We have generalized the model of \citet{Einstein1937} to derive the diffusion properties of bedload tracers transporting downstream while undergoing burial.
This reveals four stages of tracer diffusion: an initial superdiffusion $\sigma_x^2 \propto t^2$ or $t^3$ depending on initial conditions, an intermediate normal diffusion $\sigma_x^2 \propto t$, and a late or global range of diffusion $\sigma_x^2 \propto t^\gamma$ with $1\leq \gamma \leq 3$.
These conclusions are a mathematical description of the concepts suggested by \citet{Nikora2001,Nikora2002}. 
We believe the physical reasoning we've developed here can be used to build new scale-independent descriptions of sediment transport in rivers.
The .
In closing, we believe the legacy of Einstein pervades nearly all contemporary descriptions of sediment transport phenomena, as Einstein was probably the first to take account of the mechanics of individual grains in his descriptions of sediment transport \citep{Einstein1937,Einstein1942,Einstein1950}.
We speculate that geophysical descriptions of phenomena in rivers will become much more sophisticated and  in this century, and this rapid development will be driven by powerful contemporary motivators including climate change \citep{Phillips2016} and the global loss of aquatic biodiversity \citep{Hauer2016}.
Surely this scientific progress would benefit from a careful accounting of its historical foundation.


\appendix

\section{Calculation of the distribution function with trapping}
\label{sec:appendix}
Taking double transforms gives
\begin{align}
\tom_{1T}(\eta,s) &= \theta_1 \tg_1(\eta,s) + \tom_2(\eta,s)\tg_1(\eta,s)-\tom_{1F}(\eta,s) \\
\tom_{1F}(\eta,s) &= \theta_1\tg_1(\eta,s+\kappa) + \tom_2(\eta,s)\tg_1(\eta,s+\kappa)\\
\tom_2(\eta,s) &= \theta_2 \tg_2(\eta,s) + \tom_{1F}(\eta,s)\tg_2(\eta,s)
\end{align}
This system solves for 
\begin{align}
\tom_{1T}(\eta,s) &= \frac{\theta_1 + \theta_2 \tg_2(\eta,s)}{1-\tg_1(\eta,s+\kappa)\tg_2(\eta,s)}\big\{\tg_1(\eta,s)-\tg_1(\eta,s+\kappa) \big\} \\
\tom_{1F}(\eta,s) &= \frac{\theta_1 + \theta_2 \tg_2(\eta,s)}{1-\tg_1(\eta,s+\kappa)\tg_2(\eta,s)}\tg_1(\eta,s+\kappa)\\
\tom_{2}(\eta,s) &= \frac{\theta_2 + \theta_1 \tg_1(\eta,s+\kappa)}{1-\tg_1(\eta,s+\kappa)\tg_2(\eta,s)}\tg_2(\eta,s)\\
\end{align}


The probabilities of being in state $0$ (trapped), $1$ (rest), and $2$ (motion) are
\begin{align}
p_0(x,t) &= \int_0^t dt' \omega_{1T}(x,t-t')\\
p_1(x,t) &= \theta_1 G_1(x,t) + \int_0^x dx' \int_0^t dt' \omega_2(x',t')G_1(x-x',t-t')\\
p_2(x,t) &= \theta_2 G_2(x,t) + \int_0^x dx' \int_0^t dt' \omega_{1F}(x',t')G_2(x-x',t-t'),
\end{align}
Double transforming gives
\begin{align}
\tp_0(\eta,s) &= \frac{1}{s}\tom_{1T}(\eta,s)\\
\tp_1(\eta,s) &= \theta_1 \tG_1(\eta,s) + \tom_2(\eta,s) \tG_1(\eta,s) \\
\tp_2(\eta,s) &= \theta_2 \tG_2(\eta,s) + \tom_{1F}(\eta,s)\tG_2(\eta,s)\\
\end{align}
The total probability is $p(x,t) = p_0(x,t) + p_1(x,t) + p_2(x,t)$ or 
\begin{multline}
\tp(\eta,s) = \frac{1}{s}\frac{\theta_1 + \theta_2 \tg_2(\eta,s)}{1-\tg_1(\eta,s+\kappa)\tg_2(\eta,s)}\big\{\tg_1(\eta,s)-\tg_1(\eta,s+\kappa) \big\} \\
+\frac{\theta_1\big[\tG_1(\eta,s) + \tg_1(\eta,s+\kappa)\tG_2(\eta,s)\big]+ \theta_2\big[\tG_2(\eta,s) + \tg_2(\eta,s)\tG_1(\eta,s)\big]}{1-\tg_1(\eta,s+\kappa)\tg_2(\eta,s)} \\
\end{multline}
Using the identities $\tg_i(0,s) = \tilde{\psi}_i(s)$ and $\tG_i(0,s) = (1-\tilde{\psi}_i(s))/s,$ it follows that the joint distribution is normalized in space no matter the choice of propagators: $\tp(0,s) = \mathcal{L}\{\int_0^\infty dx p(x,t);s\} = 1/s$.

After a lot of work which is in your notebook, this becomes
\begin{align}
p(x,t) = e^{-(\kappa + k_1)(t-x/v)-k_2x/v}
\Big[&\frac{1}{v}\El_{s\rightarrow t-x/v}^{-1}\Big\{\exp\Big[\frac{k_1k_2}{vs}x\Big]\Big\} \\
&+ \frac{k_2}{v}\El_{s\rightarrow t-x/v}^{-1}\Big\{\frac{1}{s}\exp\Big[\frac{k_1k_2}{vs}x\Big]\Big\} \\
&+ \frac{\kappa k_2}{v}\El_{s\rightarrow t-x/v}^{-1}\Big\{\frac{1}{(s-\kappa-k_1)s}\exp\Big[\frac{k_1k_2}{vs}x\Big]\Big\}\Big]
\end{align}
\begin{align}
p(x,t) = e^{-(\kappa + k_1)(t-x/v)-k_2x/v}
\Bigg[&\frac{1}{v}\delta(t-x/v) + \frac{1}{v}\sqrt{\frac{k_1k_2x}{v(t-x/v)}}\theta(t-x/v)\mathcal{I}_1\Bigg(2\sqrt{\frac{k_1k_2x}{v}\Big(t-\frac{x}{v}\Big)}\Bigg)\\
&+\frac{k_2}{v}\theta(t-x/v)\mathcal{I}_0\Bigg(2\sqrt{\frac{k_1k_2x}{v}\Big(t-\frac{x}{v}\Big)}\Bigg)\\
&+ \kappa\frac{ k_2}{v(\kappa+k_1)}e^{(\kappa+k_1)(t-x/v)}\theta(t-x/v)\mathcal{F}(x,t)\Bigg]
\end{align}
where the function $\mathcal{F}$ is
\be \mathcal{F}(x,t) = \sum_{j=0}^\infty \frac{\big[\frac{k_1k_2x}{v(\kappa+k_1)}\big]^j}{j!j!} \gamma\big(j+1,[\kappa+k_1][t-x/v]\big),\ee
where the $\mathcal{I}_\nu(z)$ are modified Bessel functions of the first kind, and $\gamma(\alpha,z)$ is the lower incomplete gamma function.
This function $\mathcal{F}(x,t)$ is the Marcum Q-function \citep{Temme1996}, given by 
\be \mathcal{Q}_1(x,y) = 1-e^{-x}\sum_{n=0}^\infty \frac{x^n}{n!}\frac{\gamma(1+n,y)}{\Gamma(n+1)}\ee
This function was originally introduced in relation to radar detection problems \citep[e.g.][]{Marcum1960}. It has a representation as an infinite superposition of modified Bessel functions:
\be \mathcal{Q}_1(x,y) = 1- \int_0^ydz e^{-z-x}\mathcal{I}_0(2\sqrt{xz})\ee
So we are not far from where we started with \citet{Lisle1998}: Modified Bessel functions are the norm in this type of 1D diffusion problem \citep[e.g.][]{Lisle1998}.
Hence in summary \be \mathcal{F}(x,t) = 1-\mathcal{Q}_1\Big(\frac{k_1k_2x}{v(\kappa+k_1)},[\kappa+k_1][t-x/v] \Big)\ee

\section{Calculation of the moments}
\label{sec:appendix2}
Often, Tauberian-type theorems are used to study the long or short time asymptotic scaling of first or second moments of random walks having any generality.
This is because the mathematics get difficult, and Tauberian theorems provide a very powerful tool which leverages the stability of the Laplace transform.
Unfortunately, this approach is insufficient for our purposes. We are unaware of an intermediate-regime Tauberian-type theorem, so we must pursue full solutions of the moments in order to discriminate the diffusive ranges and the full diffusion behavior.

\be \partial_\eta \tp(\eta,s) = -v \frac{1}{s}\frac{[(s+\kappa + k')s + \kappa k_2][s+\kappa + k_1]}{[\eta v(s+\kappa +k_1) + (s+ \kappa + k')s+\kappa k_2]^2}\ee
\be \partial_\eta^2 \tp(\eta,s) = 2v^2 \frac{1}{s} \frac{[(s+\kappa + k')s+\kappa k_2][s+\kappa + k_1]^2}{[\eta v(s+\kappa + k_1) + (s+\kappa + k')s+ \kappa k_2]^3}\ee
\be  \frac{\bra\tilde{x}\ket} {v} = \frac{1}{s}\frac{s+\kappa + k_1}{(s+\kappa + k')s + \kappa k_2}\ee
\be \frac{\bra \tilde{x}^2 \ket}{2v^2} = \frac{1}{s} \frac{[s+\kappa + k_1]^2}{[(s+\kappa + k')s + \kappa k_2]^2} \ee

A similar approach provides 
\begin{align}
\frac{\bra x^2 \ket}{2v^2} &= \Big(\frac{d}{dt}\circ + \circ \Big|_{t=0} + 2(\kappa + k_1)\circ + (\kappa+k_1)^2\int_0^t dt \circ \Big)\El^{-1}\Big\{\frac{1}{[(s+a)^2-b^2]^2};t\Big\}\\
&= \Big(\frac{d}{dt}\circ + \circ \Big|_{t=0} + 2(\kappa + k_1)\circ + (\kappa+k_1)^2\int_0^t dt \circ \Big)\El^{-1}\Big\{\frac{1}{[s^2-b^2]^2};t\Big\}e^{-at}\\
&= \Big(\frac{d}{dt}\circ + \circ \Big|_{t=0} + 2(\kappa + k_1)\circ + (\kappa+k_1)^2\int_0^t dt \circ \Big)e^{-at}\frac{1}{2b^3}\Big[bt\cosh(bt)-\sinh(bt)\Big]
\end{align}
using Prudnikov 2.1.5.6.
This becomes
\begin{align}
\frac{\bra x^2 \ket}{2v^2} = \frac{t}{b}\sinh&(bt) + \frac{(\kappa + k_1)}{b^3}\big[bt\cosh(bt)-\sinh(bt)\big]\\
&+e^{-at}\frac{b(b^2(at-2))-a^3t)\cosh(bt) +(a^3-a^2b^2t-3ab^2+b^4t)\sinh(bt)}{(a-b)^2(a+b)^2}
\end{align}
\begin{align}
\frac{\bra x \ket}{v} &= \El^{-1}\Big\{\frac{1}{s}\frac{s+\kappa + k_1}{(s+\kappa + k')s + \kappa k_2};t\Big\} \\
&= \El^{-1}\Big\{\frac{1}{\big[s+\frac{\kappa+k'}{2}\big]^2+\kappa k_2 - \big[\frac{\kappa+k'}{2}\big]^2};t\Big\} + 
\int_0^t du \El^{-1}\Big\{\frac{\kappa + k_1}{\big[s+\frac{\kappa+k'}{2}\big]^2+\kappa k_2 - \big[\frac{\kappa+k'}{2}\big]^2};u\Big\}\\
&= e^{-(\kappa + k')t/2}\El^{-1}\Big\{\frac{1}{s^2 - b^2};t\Big\} + (\kappa + k_1)\int_0^t du e^{-(\kappa + k')u/2}\El^{-1}\Big\{\frac{1}{s^2 - b^2};u\Big\}
\end{align}
here $b^2 = -\kappa k_2 + \big[\frac{\kappa+k'}{2}\big]^2$
Then with Prudnikov 2.1.5.4:
\begin{align}
\frac{\bra x \ket}{v} &= \frac{1}{b}e^{-(\kappa + k')t/2}\sinh(bt) + \frac{(\kappa +k_1)}{b}\int_0^t due^{-(\kappa + k')u/2}\sinh(bu)\\
&=  \frac{1}{b}e^{-at}\sinh(bt) + \frac{\kappa + k_1}{2b}\Big[\frac{1}{b-a}\Big(e^{(b-a)t}-1\Big)+ \frac{1}{a+b}\Big(e^{-(a+b)t}-1\Big)\Big]
\end{align}
where $a=(\kappa + k')/2$ and $b = \sqrt{a^2 -\kappa k_2}$. We are interested in the domain that $a\geq \sqrt{\kappa k_2}$ so that $b\geq a$.
The limit of $\kappa \rightarrow 0$ provides
\be \frac{k'^2}{v}\bra x \ket=k_2(1-e^{-k't})+ k_1k't \ee
which aligns perfectly with earlier results.

\section{Links to \citet{Einstein1937} and \citet{Lisle1998}}
Turning off the trapping process by sending $\kappa \rightarrow 0 $ reproduces the earlier model of \citet{Lisle1998}. 
Noting that $b \sim k'/2 + (k_1-k_2)\kappa/(2k')$ and $a+b \sim k' + k_1\kappa/k'$ as $\kappa \rightarrow 0$ transforms (\ref{eq:mean}) to 
\be \bra x \ket \sim  \frac{vk_1}{k'}t + \frac{vk_2}{k'^2}(1-e^{-k't})\ee
in the limit, consistent with the transient solution of the \citet{Lisle1998} model.
Taking a further and slightly more intricate limit provides the theory of \citet{Einstein1937}. This involves taking the mean motion duration $1/k_2 \rightarrow 0$ while holding the mean step distance $l=v/k_2$ constant.
Denoting the mean resting time by $\tau=1/k_1$, this limits to
\be \bra x \ket \sim l + lt/\tau,\ee
consistent with the derivation of \citet{Einstein1937}.
Grains move with an effective velocity $l/\tau$ formed by the mean step distance divided by the mean resting time.
The additional factor of $l$ is associated with the initial condition: All grains started in a step, so each has already traveled (instantaneously) a distance $l$ at $t=0$.


\acknowledgments
J. Pierce acknowledges helpful exchanges with Eduardo Daly and Peter Hanggi during the early stages of this work. M. Hassan is supported by an NSERC Discovery grant. All simulation code is available on request.

\bibliography{biblio.bib}
\end{document}