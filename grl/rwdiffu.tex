%\documentclass[draft]{agujournal2018}
\documentclass[]{agujournal2018}
\usepackage{apacite}
\usepackage{url}
\usepackage{lineno}
%\linenumbers
\draftfalse
\journalname{Geophysical Research Letters}

%custom packages
\usepackage{amsmath,amssymb,amsfonts,amsthm}
% custom commands
\newcommand\be{\begin{equation}}
\newcommand\ee{\end{equation}} 
\newcommand\bra{\langle}
\newcommand\ket{\rangle}
\newcommand\om{\omega}
\newcommand\tom{\tilde{\omega}}
\newcommand\tg{\tilde{g}}
\newcommand\tp{\tilde{p}}
\newcommand\tG{\tilde{G}}
\newcommand\El{\mathcal{L}}

\begin{document}

\title{Back to Einstein: how to include trapping processes in fluvial diffusion models?}

\authors{James K. Pierce \affil{1}and Marwan A. Hassan\affil{1}}
\affiliation{1}{University of British Columbia}
\correspondingauthor{James Kevin Pierce}{kpierce@alumni.ubc.ca}

\begin{keypoints}
\item We generalize the bedload diffusion model of Hans Albert Einstein to include motion intervals and sediment trapping processes.
\item This derives three stages of bedload diffusion and unambiguously attributes physical mechanisms to each stage.
\end{keypoints}

\begin{abstract}
One approach to predict geomorphic change in rivers is to upscale from the motions of individual sediment grains. A difficulty with this approach is the wide range of individual motion characteristics that imply sediment diffusion, or the spreading out of grains through time. A more acute difficulty is that these motion characteristics apparently vary across temporal and spatial scales, implying multiple stages of sediment diffusion. We relate this multi-stage diffusion to within-channel trapping processes that impede the motions of individual grains. Grains can become stranded on high bars during floods, or they can become buried within the sedimentary bed, but these processes take a relatively long time to occur. Drawing on ideas from condensed matter physics and cellular biology, we describe the motions of individual grains within channels as random walkers subject to trapping. This derives multi-stage diffusion and clarifies its mechanism, providing a tool to link between scales.
\end{abstract}

\section{Introduction}
% " The problem of anomalous transport has ... "
The random walk has been a ubiquitous model of natural phenomena across the physical sciences.
The model was developed by the scientific giant Albert Einstein, who effectively used it to provide support for the molecular hypothesis \citep{Einstein1905}.
Some decades later, his son Hans Albert Einstein (Einstein), who was a scientific giant in his own right \citep[e.g.][]{Ettema2004a}, generalized the model to describe the transport of sediment grains through gravel-bed rivers \citep{Einstein1937}.
Under typical conditions in these rivers, flowing water causes sediment grains to move in an intermittent way, rolling, sliding, and bouncing along the bed, in a mode of motion referred to as bedload \citep{Bagnold1973}.

The interactions of moving bedload grains with the bed and turbulent fluid flow have been notoriously difficult to quantify \citep[e.g.][]{Schmeeckle2007,Gordon1972,Dwivedi2011,Celik2014}, but the basic phenomenology is simple: individual grains move through the fluid in an alternating sequence of steps and rests \citep{Einstein1937, Einstein1950,Ancey2008,Heyman2016,Hassan2017}.
Einstein started here. 
By holding that step durations were so short relative to rest durations as to be effectively instantaneous, Einstein formulated the transport of individual bedload grains as an alternating sum of random variables.
By convolving across sequences of rest and motion, he predicted the effective velocity of individual bedload grains, and he discerned the manner in which grains should spread apart or diffuse as they transport downstream due to differences in the motion characteristics of one grain and the next.
Einstein's theory predicted a single stage of diffusion, whereby the mean-squared distance $\sigma_x^2$ between grains scales with time $t$ as $\sigma_x^2 \propto t$. This type of diffusion is called normal, in contrast to anomalous. Normal diffusion was seen in many early 20th century scientific problems \citep[e.g][]{Einstein1905,Taylor1920}.

\citet{Montroll1965} formalized the approach of \citet{Einstein1937} in the language of mathematical physics, generalized it, and gave it a name: the continuous time random walk (CTRW). There's no indication they were aware of Einstein's pioneering work in doing so. Since their work, use of the model has exploded, with applications in physics \citep{Scher1973}, hydrology \citep{Rodriguez-Iturbe1987,Daly2006a}, chemistry \citep{Shugard1976}, biology \cite{Sokolov2012}, geology \citep{Berkowitz2006}.
There are really too many applications to cite, but maybe the prevalence of review works give some indication \citep[e.g.][]{Codling2008,Masoliver2017,Berkowitz2006,Kutner2017,Metzler2000,Weiss1994}.

Sediment transport has been no exception to this trend. There are more recent works which can be characterized as direct applications of random walks \citep{Lisle1998}, or at the very least can be perceived as intimately linked to them \citep{Zhang2012, Ancey2014,Wu2019}.
This is not to mention the large number of earlier works which are direct revisions and generalizations of Einstein \citep{Yang1971,Gordon1972,Hubbell1964,Sayre1965,Nakagawa1976,Nakagawa1980,Yano1969,Shen1980}.
Within these contemporary river science works, a realization has emerged which Einstein was unaware of. In fact, the experimental methods of his day were technologically insufficient to resolve it. Sediment diffusion can be anomalous, meaning the rate of spreading of grains as they transport scales as $\sigma_x^2 \propto t^\alpha$ with $\alpha\neq1$.
The anomalous transport of bedload is exotic. 
It expresses at least three stages \citep{Nikora2001a}, and several conceptual models for this have been put forth \citep{Nikora2002, Martin2012}. Several works have concentrated on deriving these three stages \citep[e.g.][]{Fan2016,Zhang2012}, and others have concentrated on the asymptotic regime of large times \citep{Bradley2017,Hassan2017} which draws on the problem of the assymmetric random walk \citep[e.g.][]{Weeks1996,Weeks1998}.
However, investigators have only just begun to characterize these three stages with quantitative models \citep[e.g.][]{Wu2019}.
There is a need to do this.
To this end, we suggest a means to include a trapping mechanism in random walk models.
Probably you need to highlight that similar inclusions have already been made in one state models, and you need to highlight the progression of Einstein-type models through Hubbell and Shen into Lisle, which was the first einstein-type model which is fundamentally different in its inclusion of finite motion periods.
Anomalous transport has been realized in many fields, such as charge transport in disordered solids \citep[e.g.][]{Scher1973}, dynamics across lipid bilayers \citep{Jeon2012,Molina-Garcia2018}, chemistry issues (look deeper) \citep{Metzler2014}, transport through porous media \citep{AaraoReis2014,Yang2019}, dipoles in an electric field \citep{Jordanovic2011}, asymmetric random walks \citep{Weeks1996,Weeks1998} and so on. There are several review articles on anomalous transport \citep{Klafter2005,Klages2008,Sokolov2012} and there have been many attempts to model it from a fundamental standpoint \citep{Gorenflo2008,Pottier2003,Fedotov2015,Flekk√∏y2017}.
Anyway, there's a bunch of references and a general logic flow starting to precipitate for an introduction.

\section{Bedload diffusion with trapping}
To include motion, rest, and trapping, and to keep track of grains which fall into the trapped state, we need to introduce a three-state random walk.
The multistate random walk was first considered by \citet{Weiss1976} and it is reviewed in \citet{Weiss1994}.
\begin{align}
\om_{1T}(x,t) &= \theta_1\big[1-\Phi(t)\big]g_1(x,t) + \int_0^x dx' \int_0^t dt' \om_2(x',t')\big[1-\Phi(t)\big]g_1(x-x',t-t')\\
\om_{1F}(x,t) &= \theta_1\Phi(t)g_1(x,t) + \int_0^x dx' \int_0^t dt' \om_2(x',t') \Phi(t) g_1(x-x',t-t')\\
\om_2(x,t) &= \theta_2 g_2(x,t) + \int_0^x dx' \int_0^t dt' \om_{1F}(x',t')g_2(x-x',t-t')\\
\end{align}
Taking double transforms gives
\begin{align}
\tom_{1T}(\eta,s) &= \theta_1 \tg_1(\eta,s) + \tom_2(\eta,s)\tg_1(\eta,s)-\tom_{1F}(\eta,s) \\
\tom_{1F}(\eta,s) &= \theta_1\tg_1(\eta,s+\kappa) + \tom_2(\eta,s)\tg_1(\eta,s+\kappa)\\
\tom_2(\eta,s) &= \theta_2 \tg_2(\eta,s) + \tom_{1F}(\eta,s)\tg_2(\eta,s)
\end{align}
This system solves for 
\begin{align}
\tom_{1T}(\eta,s) &= \frac{\theta_1 + \theta_2 \tg_2(\eta,s)}{1-\tg_1(\eta,s+\kappa)\tg_2(\eta,s)}\big\{\tg_1(\eta,s)-\tg_1(\eta,s+\kappa) \big\} \\
\tom_{1F}(\eta,s) &= \frac{\theta_1 + \theta_2 \tg_2(\eta,s)}{1-\tg_1(\eta,s+\kappa)\tg_2(\eta,s)}\tg_1(\eta,s+\kappa)\\
\tom_{2}(\eta,s) &= \frac{\theta_2 + \theta_1 \tg_1(\eta,s+\kappa)}{1-\tg_1(\eta,s+\kappa)\tg_2(\eta,s)}\tg_2(\eta,s)\\
\end{align}


The probabilities of being in state $0$ (trapped), $1$ (rest), and $2$ (motion) are
\begin{align}
p_0(x,t) &= \int_0^t dt' \omega_{1T}(x,t-t')\\
p_1(x,t) &= \theta_1 G_1(x,t) + \int_0^x dx' \int_0^t dt' \omega_2(x',t')G_1(x-x',t-t')\\
p_2(x,t) &= \theta_2 G_2(x,t) + \int_0^x dx' \int_0^t dt' \omega_{1F}(x',t')G_2(x-x',t-t'),
\end{align}
Double transforming gives
\begin{align}
\tp_0(\eta,s) &= \frac{1}{s}\tom_{1T}(\eta,s)\\
\tp_1(\eta,s) &= \theta_1 \tG_1(\eta,s) + \tom_2(\eta,s) \tG_1(\eta,s) \\
\tp_2(\eta,s) &= \theta_2 \tG_2(\eta,s) + \tom_{1F}(\eta,s)\tG_2(\eta,s)\\
\end{align}
The total probability is $p(x,t) = p_0(x,t) + p_1(x,t) + p_2(x,t)$ or 
\begin{multline}
\tp(\eta,s) = \frac{1}{s}\frac{\theta_1 + \theta_2 \tg_2(\eta,s)}{1-\tg_1(\eta,s+\kappa)\tg_2(\eta,s)}\big\{\tg_1(\eta,s)-\tg_1(\eta,s+\kappa) \big\} \\
+\frac{\theta_1\big[\tG_1(\eta,s) + \tg_1(\eta,s+\kappa)\tG_2(\eta,s)\big]+ \theta_2\big[\tG_2(\eta,s) + \tg_2(\eta,s)\tG_1(\eta,s)\big]}{1-\tg_1(\eta,s+\kappa)\tg_2(\eta,s)} \\
\end{multline}
Using the identities $\tg_i(0,s) = \tilde{\psi}_i(s)$ and $\tG_i(0,s) = (1-\tilde{\psi}_i(s))/s,$ it follows that the joint distribution is normalized in space: $\tp(0,s) = \mathcal{L}\{\int_0^\infty dx p(x,t);s\} = 1/s$.
Taking the limit of zero trapping rate $\kappa \rightarrow 0$ the equations reduce to a two-state random walk equivalent to the theories of \citet{Einstein1937} and \citet{Lisle1998}, equation (6.33) in \citet{Weiss1994}. This all seems correct.
Setting $g_1(x,t) = \delta(x)k_1e^{-k_1t}$ and $g_2(x,t) = \delta(x-vt)k_2e^{-k_2 t}$ gives the Laplace representations
\begin{align}
\tg_1(\eta,s) &= \frac{k_1}{k_1 + s}\\
\tg_2(\eta,s) &=  \frac{k_2}{k_2 + \eta v + s} \\
\tG_i(\eta,s) &= \frac{\tg_i(\eta,s)}{k_i}
\end{align}
In terms of these propagators and assuming tracers start in motion $\theta_2 =1$ gives the form
\be \tp(\eta,s) =\frac{1}{s} \frac{(s+\kappa+k')s + \kappa k_2}{\eta v(s + \kappa + k_1) + (s+ \kappa + k')s + \kappa k_2} \ee
with $k' = k_1 + k_2$. Taking $\kappa \rightarrow 0$ gives an earlier result.


\subsection{distribution function}
After a lot of work which is in your notebook, this becomes
\begin{align}
p(x,t) = e^{-(\kappa + k_1)(t-x/v)-k_2x/v}
\Big[&\frac{1}{v}\El_{s\rightarrow t-x/v}^{-1}\Big\{\exp\Big[\frac{k_1k_2}{vs}x\Big]\Big\} \\
&+ \frac{k_2}{v}\El_{s\rightarrow t-x/v}^{-1}\Big\{\frac{1}{s}\exp\Big[\frac{k_1k_2}{vs}x\Big]\Big\} \\
&+ \frac{\kappa k_2}{v}\El_{s\rightarrow t-x/v}^{-1}\Big\{\frac{1}{(s-\kappa-k_1)s}\exp\Big[\frac{k_1k_2}{vs}x\Big]\Big\}\Big]
\end{align}
\begin{align}
p(x,t) = e^{-(\kappa + k_1)(t-x/v)-k_2x/v}
\Bigg[&\frac{1}{v}\delta(t-x/v) + \frac{1}{v}\sqrt{\frac{k_1k_2x}{v(t-x/v)}}\theta(t-x/v)\mathcal{I}_1\Bigg(2\sqrt{\frac{k_1k_2x}{v}\Big(t-\frac{x}{v}\Big)}\Bigg)\\
&+\frac{k_2}{v}\theta(t-x/v)\mathcal{I}_0\Bigg(2\sqrt{\frac{k_1k_2x}{v}\Big(t-\frac{x}{v}\Big)}\Bigg)\\
&+ \kappa\frac{ k_2}{v(\kappa+k_1)}e^{(\kappa+k_1)(t-x/v)}\theta(t-x/v)\mathcal{F}(x,t)\Bigg]
\end{align}
where the function $\mathcal{F}$ is
\be \mathcal{F}(x,t) = \sum_{j=0}^\infty \frac{\big[\frac{k_1k_2x}{v(\kappa+k_1)}\big]^j}{j!j!} \gamma\big(j+1,[\kappa+k_1][t-x/v]\big),\ee
where the $\mathcal{I}_\nu(z)$ are modified Bessel functions of the first kind, and $\gamma(\alpha,z)$ is the lower incomplete gamma function.
This function $\mathcal{F}(x,t)$ is the Marcum Q-function \citep{Temme1996}, given by 
\be \mathcal{Q}_1(x,y) = 1-e^{-x}\sum_{n=0}^\infty \frac{x^n}{n!}\frac{\gamma(1+n,y)}{\Gamma(n+1)}\ee
This function was originally introduced in relation to radar detection problems \citep[e.g.][]{Marcum1960}. It has a representation as an infinite superposition of modified Bessel functions:
\be \mathcal{Q}_1(x,y) = 1- \int_0^ydz e^{-z-x}\mathcal{I}_0(2\sqrt{xz})\ee
So we are not far from where we started with \citet{Lisle1998}: Modified Bessel functions are the norm in this type of 1D diffusion problem \citep[e.g.][]{Lisle1998}.
Hence in summary \be \mathcal{F}(x,t) = 1-\mathcal{Q}_1\Big(\frac{k_1k_2x}{v(\kappa+k_1)},[\kappa+k_1][t-x/v] \Big)\ee
\subsection{moments from motion}
Often, Tauberian-type theorems are used to study the long or short time asymptotic scaling of first or second moments of random walks having any generality.
This is because the mathematics get difficult, and Tauberian theorems provide a very powerful tool which leverages the stability of the Laplace transform.
Unfortunately, this approach is insufficient for our purposes. We are unaware of an intermediate-regime Tauberian-type theorem, so we must pursue full solutions of the moments in order to discriminate the diffusive ranges and the full diffusion behavior.

\be \partial_\eta \tp(\eta,s) = -v \frac{1}{s}\frac{[(s+\kappa + k')s + \kappa k_2][s+\kappa + k_1]}{[\eta v(s+\kappa +k_1) + (s+ \kappa + k')s+\kappa k_2]^2}\ee
\be \partial_\eta^2 \tp(\eta,s) = 2v^2 \frac{1}{s} \frac{[(s+\kappa + k')s+\kappa k_2][s+\kappa + k_1]^2}{[\eta v(s+\kappa + k_1) + (s+\kappa + k')s+ \kappa k_2]^3}\ee
\be  \frac{\bra\tilde{x}\ket} {v} = \frac{1}{s}\frac{s+\kappa + k_1}{(s+\kappa + k')s + \kappa k_2}\ee
\be \frac{\bra \tilde{x}^2 \ket}{2v^2} = \frac{1}{s} \frac{[s+\kappa + k_1]^2}{[(s+\kappa + k')s + \kappa k_2]^2} \ee
\subsubsection{the mean}
\begin{align}
\frac{\bra x \ket}{v} &= \El^{-1}\Big\{\frac{1}{s}\frac{s+\kappa + k_1}{(s+\kappa + k')s + \kappa k_2};t\Big\} \\
&= \El^{-1}\Big\{\frac{1}{\big[s+\frac{\kappa+k'}{2}\big]^2+\kappa k_2 - \big[\frac{\kappa+k'}{2}\big]^2};t\Big\} + 
\int_0^t du \El^{-1}\Big\{\frac{\kappa + k_1}{\big[s+\frac{\kappa+k'}{2}\big]^2+\kappa k_2 - \big[\frac{\kappa+k'}{2}\big]^2};u\Big\}\\
&= e^{-(\kappa + k')t/2}\El^{-1}\Big\{\frac{1}{s^2 - b^2};t\Big\} + (\kappa + k_1)\int_0^t du e^{-(\kappa + k')u/2}\El^{-1}\Big\{\frac{1}{s^2 - b^2};u\Big\}
\end{align}
here $b^2 = -\kappa k_2 + \big[\frac{\kappa+k'}{2}\big]^2$
Then with Prudnikov 2.1.5.4:
\begin{align}
\frac{\bra x \ket}{v} &= \frac{1}{b}e^{-(\kappa + k')t/2}\sinh(bt) + \frac{(\kappa +k_1)}{b}\int_0^t due^{-(\kappa + k')u/2}\sinh(bu)\\
&=  \frac{1}{b}e^{-at}\sinh(bt) + \frac{\kappa + k_1}{2b}\Big[\frac{1}{b-a}\Big(e^{(b-a)t}-1\Big)+ \frac{1}{a+b}\Big(e^{-(a+b)t}-1\Big)\Big]
\end{align}
where $a=(\kappa + k')/2$ and $b = \sqrt{a^2 -\kappa k_2}$. We are interested in the domain that $a\geq \sqrt{\kappa k_2}$ so that $b\geq a$.
The limit of $\kappa \rightarrow 0$ provides
\be \frac{k'^2}{v}\bra x \ket=k_2(1-e^{-k't})+ k_1k't \ee
which aligns perfectly with earlier results.


\subsubsection{the second moment}
A similar approach provides 
\begin{align}
\frac{\bra x^2 \ket}{2v^2} &= \Big(\frac{d}{dt}\circ + \circ \Big|_{t=0} + 2(\kappa + k_1)\circ + (\kappa+k_1)^2\int_0^t dt \circ \Big)\El^{-1}\Big\{\frac{1}{[(s+a)^2-b^2]^2};t\Big\}\\
&= \Big(\frac{d}{dt}\circ + \circ \Big|_{t=0} + 2(\kappa + k_1)\circ + (\kappa+k_1)^2\int_0^t dt \circ \Big)\El^{-1}\Big\{\frac{1}{[s^2-b^2]^2};t\Big\}e^{-at}\\
&= \Big(\frac{d}{dt}\circ + \circ \Big|_{t=0} + 2(\kappa + k_1)\circ + (\kappa+k_1)^2\int_0^t dt \circ \Big)e^{-at}\frac{1}{2b^3}\Big[bt\cosh(bt)-\sinh(bt)\Big]
\end{align}
using Prudnikov 2.1.5.6.
This becomes
\begin{align}
\frac{\bra x^2 \ket}{2v^2} = \frac{t}{b}\sinh&(bt) + \frac{(\kappa + k_1)}{b^3}\big[bt\cosh(bt)-\sinh(bt)\big]\\
&+e^{-at}\frac{b(b^2(at-2))-a^3t)\cosh(bt) +(a^3-a^2b^2t-3ab^2+b^4t)\sinh(bt)}{(a-b)^2(a+b)^2}
\end{align}


\section{Discussion: new findings and foundational links}
\section{Conclusion}


\appendix
\section{Mathematical appendix}

\acknowledgments
J. Pierce thanks Mindy Saunders  and Leonardo Golubovic for years of careful guidance in mathematics. He acknowledges helpful exchanges with Eduardo Daly and Peter Hanggi during the early stages of this work. M. Hassan acknowledges support from the NSERC Discovery program. All simulation codes are available on request from the first author.

\bibliography{biblio.bib}
\end{document}